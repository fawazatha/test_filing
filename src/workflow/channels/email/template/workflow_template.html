<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Market Digest</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    th { white-space: nowrap !important; }
    .nowrap { white-space: nowrap !important; }
    .table-wrap { overflow-x: auto; -webkit-overflow-scrolling: touch; }
    @media only screen and (max-width: 600px) {
      .container { width: 100% !important; }
      .content { padding: 16px !important; }
      .header-title { font-size: 20px !important; }
      .two-col { display: block !important; }
      .col { width: 100% !important; margin-bottom: 24px !important; }
      table { font-size: 12px !important; }
      th, td { padding: 6px 4px !important; }
    }
  </style>
</head>
<body style="margin:0;padding:0;background:#f8fafc;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Oxygen,Ubuntu,Cantarell,sans-serif;">
  <table role="presentation" cellpadding="0" cellspacing="0" border="0" width="100%" style="background:#f8fafc;">
    <tr>
      <td align="center" style="padding:32px 16px;">
        <table role="presentation" cellpadding="0" cellspacing="0" border="0" width="600" class="container" style="max-width:600px;background:#ffffff;border-radius:12px;box-shadow:0 4px 6px -1px rgba(0,0,0,0.1);">
          
          <!-- Global Header -->
          <tr>
            <td class="content" style="padding:32px 32px 24px 32px;">
              <h1 class="header-title" style="margin:0 0 8px 0;font-size:24px;line-height:32px;font-weight:700;color:#1f2937;">
                Market Digest - {{ as_of or "DD/MM/YYYY" }}
              </h1>

              <div style="margin:0 0 24px 0;color:#6b7280;font-size:16px;line-height:24px;font-weight:500;">
                <strong>{{ window_start }}</strong> ‚Üí <strong>{{ window_end }}</strong> (WIB)
              </div>
            </td>
          </tr>

          {# === UPCOMING DIVIDENDS CARD === #}
          {% if dividends | default([]) | length > 0 %}
          <tr>
            <td class="content" style="padding:0 32px 24px 32px;">
              <h2 style="margin:0 0 12px 0;font-size:18px;line-height:26px;font-weight:700;color:#1f2937;">
                üìà Upcoming Dividends
              </h2>
              <div class="table-wrap" style="overflow-x:auto;">
                <table role="presentation" cellpadding="0" cellspacing="0" border="0" width="100%"
                       style="min-width:700px;border-collapse:collapse;border:1px solid #e5e7eb;border-radius:8px;overflow:hidden;">
                  <thead>
                    <tr style="background:#f3f4f6;">
                      <th align="left"   style="padding:12px 16px;font-size:12px;font-weight:600;color:#374151;text-transform:uppercase;letter-spacing:0.5px;border-bottom:1px solid #e5e7eb;">Ticker</th>
                      <th align="left"   style="padding:12px 16px;font-size:12px;font-weight:600;color:#374151;text-transform:uppercase;letter-spacing:0.5px;border-bottom:1px solid #e5e7eb;">Company</th>
                      <th align="center" style="padding:12px 16px;font-size:12px;font-weight:600;color:#374151;text-transform:uppercase;letter-spacing:0.5px;border-bottom:1px solid #e5e7eb;">Ex-Date</th>
                      <th align="right"  style="padding:12px 16px;font-size:12px;font-weight:600;color:#374151;text-transform:uppercase;letter-spacing:0.5px;border-bottom:1px solid #e5e7eb;">Div/Share</th>
                      <th align="right"  style="padding:12px 16px;font-size:12px;font-weight:600;color:#374151;text-transform:uppercase;letter-spacing:0.5px;border-bottom:1px solid #e5e7eb;">Yield</th>
                      <th align="center" style="padding:12px 16px;font-size:12px;font-weight:600;color:#374151;text-transform:uppercase;letter-spacing:0.5px;border-bottom:1px solid #e5e7eb;">Pay-Date</th>
                    </tr>
                  </thead>
                  <tbody>
                    {% for d in dividends %}
                    <tr style="border-bottom:1px solid #f3f4f6;">
                      <td style="padding:12px 16px;font-size:14px;color:#1f2937;font-weight:700;">
                        {{ d.ticker }}
                      </td>
                      <td style="padding:12px 16px;font-size:13px;color:#6b7280;">
                        {{ d.company }}
                      </td>
                      <td align="center" class="nowrap" style="padding:12px 16px;font-size:13px;color:#1f2937;">
                        {{ d.ex_date }}
                      </td>
                      <td align="right" class="nowrap" style="padding:12px 16px;font-size:14px;color:#1f2937;font-weight:600;">
                        {{ d.div_share | format_idr }}
                      </td>
                      <td align="right" class="nowrap" style="padding:12px 16px;font-size:14px;color:#059669;font-weight:600;">
                        {{ d.yield }}%
                      </td>
                      <td align="center" class="nowrap" style="padding:12px 16px;font-size:13px;color:#6b7280;">
                        {{ d.pay_date }}
                      </td>
                    </tr>
                    {% endfor %}
                  </tbody>
                </table>
              </div>
            </td>
          </tr>
          {% endif %}

          {# === INSIDER TRADING CARD === #}
          {% if insider_rows | default([]) | length > 0 %}
          <tr>
            <td class="content" style="padding:0 32px 24px 32px;">
              <h2 style="margin:0 0 12px 0;font-size:18px;line-height:26px;font-weight:700;color:#1f2937;">
                üîç Insider Trading Activity
              </h2>

              <div style="border:1px solid #e5e7eb;border-radius:8px;overflow:hidden;margin-bottom:16px;">
                <div class="table-wrap" style="overflow-x:auto;">
                  <table role="presentation" cellpadding="0" cellspacing="0" border="0" width="100%"
                         style="min-width:820px;border-collapse:collapse;">
                    <thead>
                      <tr style="background:#f8fafc;">
                        <th align="left"   style="padding:12px 16px;font-size:11px;font-weight:600;color:#374151;text-transform:uppercase;letter-spacing:0.5px;border-bottom:1px solid #e5e7eb;">Symbol</th>
                        <th align="left"   style="padding:12px 16px;font-size:11px;font-weight:600;color:#374151;text-transform:uppercase;letter-spacing:0.5px;border-bottom:1px solid #e5e7eb;">Holder</th>
                        <th align="center" style="padding:12px 16px;font-size:11px;font-weight:600;color:#374151;text-transform:uppercase;letter-spacing:0.5px;border-bottom:1px solid #e5e7eb;">Type</th>
                        <th align="right"  style="padding:12px 16px;font-size:11px;font-weight:600;color:#374151;text-transform:uppercase;letter-spacing:0.5px;border-bottom:1px solid #e5e7eb;">Price</th>
                        <th align="right"  style="padding:12px 16px;font-size:11px;font-weight:600;color:#374151;text-transform:uppercase;letter-spacing:0.5px;border-bottom:1px solid #e5e7eb;">Value</th>
                        <th align="right"  style="padding:12px 16px;font-size:11px;font-weight:600;color:#374151;text-transform:uppercase;letter-spacing:0.5px;border-bottom:1px solid #e5e7eb;">Amount</th>
                        <th align="right"  style="padding:12px 16px;font-size:11px;font-weight:600;color:#374151;text-transform:uppercase;letter-spacing:0.5px;border-bottom:1px solid #e5e7eb;">% Tx</th>
                        <th align="center" style="padding:12px 16px;font-size:11px;font-weight:600;color:#374151;text-transform:uppercase;letter-spacing:0.5px;border-bottom:1px solid #e5e7eb;">Time</th>
                      </tr>
                    </thead>
                    <tbody>
                      {% for f in insider_rows %}
                      <tr style="border-bottom:1px solid #f3f4f6;">
                        <td style="padding:12px 16px;font-size:13px;color:#1f2937;font-weight:500;">
                          {{ f.symbol }}
                        </td>
                        <td style="padding:12px 16px;font-size:13px;color:#1f2937;font-weight:500;">
                          {{ f.holder }}
                        </td>
                        <td align="center" style="padding:12px 16px;">
                          {% if f.type == 'buy' %}
                            <span style="display:inline-block;padding:3px 10px;background:#dcfce7;color:#166534;font-size:11px;font-weight:700;border-radius:20px;">BUY</span>
                          {% else %}
                            <span style="display:inline-block;padding:3px 10px;background:#fee2e2;color:#dc2626;font-size:11px;font-weight:700;border-radius:20px;">SELL</span>
                          {% endif %}
                        </td>
                        <td align="right" class="nowrap" style="padding:12px 16px;font-size:13px;color:#1f2937;font-weight:500;">
                          {{ f.price | format_abbrev }}
                        </td>
                        <td align="right" class="nowrap" style="padding:12px 16px;font-size:13px;font-weight:700;{% if f.type == 'buy' %}color:#166534;{% else %}color:#dc2626;{% endif %}">
                          {{ f.value | format_abbrev }}
                        </td>
                        <td align="right" class="nowrap" style="padding:12px 16px;font-size:13px;font-weight:600;color:#1f2937;">
                          {{ f.amount | format_abbrev }}
                        </td>
                        <td align="right" class="nowrap" style="padding:12px 16px;font-size:13px;font-weight:600;{% if f.type == 'buy' %}color:#166534;{% else %}color:#dc2626;{% endif %}">
                          {{ f.pct_tx }}%
                        </td>
                        <td align="center" class="nowrap" style="padding:12px 16px;font-size:12px;color:#6b7280;">
                          {{ f.time }}
                        </td>
                      </tr>
                      {% endfor %}
                    </tbody>
                  </table>
                </div>
              </div>
            </td>
          </tr>
          {% endif %}

          {# === INSTITUTION ACTIVITY CARD === #}
          {% if (inst_buys | default([]) | length > 0) or (inst_sells | default([]) | length > 0) %}
          <tr>
            <td class="content" style="padding:0 32px 24px 32px;">
              <h2 style="margin:0 0 12px 0;font-size:18px;line-height:26px;font-weight:700;color:#1f2937;">
                üè¢ Institution Activity (Last Month)
              </h2>
              <table role="presentation" cellpadding="0" cellspacing="0" border="0" width="100%" style="border-collapse:collapse;">
                <tr class="two-col">

                  {% if inst_buys | default([]) | length > 0 %}
                  <!-- Institutional Buys -->
                  <td class="col" style="width:48%;padding-right:16px;vertical-align:top;">
                    <div style="border:1px solid #dcfce7;border-radius:8px;overflow:hidden;background:#f0fdf4;">
                      <div style="padding:16px;background:#dcfce7;">
                        <div style="font-weight:700;font-size:14px;color:#166534;">üü¢ Institutional Buys</div>
                      </div>
                      <div class="table-wrap" style="overflow-x:auto;">
                        <table role="presentation" cellpadding="0" cellspacing="0" border="0" width="100%" style="border-collapse:collapse;">
                          <thead>
                            <tr style="background:#ecfdf5;">
                              <th align="left" style="padding:10px 12px;font-size:11px;font-weight:600;color:#166534;text-transform:uppercase;">Ticker</th>
                              <th align="right" style="padding:10px 12px;font-size:11px;font-weight:600;color:#166534;text-transform:uppercase;">Value</th>
                            </tr>
                          </thead>
                          <tbody>
                            {% for b in inst_buys %}
                            <tr style="border-bottom:1px solid #dcfce7;">
                              <td style="padding:10px 12px;font-size:13px;color:#1f2937;font-weight:600;">
                                {{ b.ticker }}
                              </td>
                              <td align="right" class="nowrap" style="padding:10px 12px;font-size:13px;font-weight:700;color:#166534;">
                                {{ b.value | format_idr_abbrev }}
                              </td>
                            </tr>
                            {% endfor %}
                          </tbody>
                        </table>
                      </div>
                    </div>
                  </td>
                  {% endif %}

                  {% if inst_sells | default([]) | length > 0 %}
                  <!-- Institutional Sells -->
                  <td class="col" style="width:48%;padding-left:16px;vertical-align:top;">
                    <div style="border:1px solid #fee2e2;border-radius:8px;overflow:hidden;background:#fef2f2;">
                      <div style="padding:16px;background:#fee2e2;">
                        <div style="font-weight:700;font-size:14px;color:#dc2626;">üî¥ Institutional Sells</div>
                      </div>
                      <div class="table-wrap" style="overflow-x:auto;">
                        <table role="presentation" cellpadding="0" cellspacing="0" border="0" width="100%" style="border-collapse:collapse;">
                          <thead>
                            <tr style="background:#fef5f5;">
                              <th align="left" style="padding:10px 12px;font-size:11px;font-weight:600;color:#dc2626;text-transform:uppercase;">Ticker</th>
                              <th align="right" style="padding:10px 12px;font-size:11px;font-weight:600;color:#dc2626;text-transform:uppercase;">Value</th>
                            </tr>
                          </thead>
                          <tbody>
                            {% for s in inst_sells %}
                            <tr style="border-bottom:1px solid #fee2e2;">
                              <td style="padding:10px 12px;font-size:13px;color:#1f2937;font-weight:600;">
                                {{ s.ticker }}
                              </td>
                              <td align="right" class="nowrap" style="padding:10px 12px;font-size:13px;font-weight:700;color:#dc2626;">
                                {{ s.value | format_idr_abbrev }}
                              </td>
                            </tr>
                            {% endfor %}
                          </tbody>
                        </table>
                      </div>
                    </div>
                  </td>
                  {% endif %}

                </tr>
              </table>
            </td>
          </tr>
          {% endif %}

          {# === PERFORMANCE REPORT CARD === #}
          {% if (leaders | default([]) | length > 0) or (laggards | default([]) | length > 0) %}
          <tr>
            <td class="content" style="padding:0 32px 24px 32px;">
              <h2 style="margin:0 0 12px 0;font-size:18px;line-height:26px;font-weight:700;color:#1f2937;">
                üìä Performance Report
              </h2>
              <div style="margin:0 0 12px 0;color:#6b7280;font-size:14px;line-height:20px;font-weight:500;">
                <strong>{{ period }}</strong> Performance
              </div>
              <table role="presentation" cellpadding="0" cellspacing="0" border="0" width="100%" style="border-collapse:collapse;">
                <tr class="two-col">

                  {% if leaders | default([]) | length > 0 %}
                  <!-- Leaders -->
                  <td class="col" style="width:48%;padding-right:16px;vertical-align:top;">
                    <div style="border:1px solid #dcfce7;border-radius:8px;overflow:hidden;background:#f0fdf4;">
                      <div style="padding:16px;background:#dcfce7;border-bottom:1px solid #dcfce7;">
                        <div style="font-weight:700;font-size:14px;color:#166534;">üöÄ Top Leaders</div>
                      </div>
                      <div class="table-wrap" style="overflow-x:auto;">
                        <table role="presentation" cellpadding="0" cellspacing="0" border="0" width="100%" style="border-collapse:collapse;">
                          <thead>
                            <tr style="background:#ecfdf5;">
                              <th align="left" style="padding:10px 12px;font-size:11px;font-weight:600;color:#166534;text-transform:uppercase;">Ticker</th>
                              <th align="right" style="padding:10px 12px;font-size:11px;font-weight:600;color:#166534;text-transform:uppercase;">1M</th>
                              <th align="right" style="padding:10px 12px;font-size:11px;font-weight:600;color:#166534;text-transform:uppercase;">1Y</th>
                            </tr>
                          </thead>
                          <tbody>
                            {% for item in leaders %}
                            <tr style="border-bottom:1px solid #dcfce7;">
                              <td style="padding:10px 12px;font-size:13px;color:#1f2937;font-weight:600;">
                                {{ item.ticker }}
                              </td>
                              <td align="right" class="nowrap" style="padding:10px 12px;font-size:13px;font-weight:700;color:#166534;">
                                {{ item.return_1m }}%
                              </td>
                              <td align="right" class="nowrap" style="padding:10px 12px;font-size:13px;font-weight:700;color:#166534;">
                                {{ item.return_1y }}%
                              </td>
                            </tr>
                            {% endfor %}
                          </tbody>
                        </table>
                      </div>
                    </div>
                  </td>
                  {% endif %}

                  {% if laggards | default([]) | length > 0 %}
                  <!-- Laggards -->
                  <td class="col" style="width:48%;padding-left:16px;vertical-align:top;">
                    <div style="border:1px solid #fee2e2;border-radius:8px;overflow:hidden;background:#fef2f2;">
                      <div style="padding:16px;background:#fee2e2;border-bottom:1px solid #fee2e2;">
                        <div style="font-weight:700;font-size:14px;color:#dc2626;">üìâ Top Laggards</div>
                      </div>
                      <div class="table-wrap" style="overflow-x:auto;">
                        <table role="presentation" cellpadding="0" cellspacing="0" border="0" width="100%" style="border-collapse:collapse;">
                          <thead>
                            <tr style="background:#fef5f5;">
                              <th align="left" style="padding:10px 12px;font-size:11px;font-weight:600;color:#dc2626;text-transform:uppercase;">Ticker</th>
                              <th align="right" style="padding:10px 12px;font-size:11px;font-weight:600;color:#dc2626;text-transform:uppercase;">1M</th>
                              <th align="right" style="padding:10px 12px;font-size:11px;font-weight:600;color:#dc2626;text-transform:uppercase;">1Y</th>
                            </tr>
                          </thead>
                          <tbody>
                            {% for item in laggards %}
                            <tr style="border-bottom:1px solid #fee2e2;">
                              <td style="padding:10px 12px;font-size:13px;color:#1f2937;font-weight:600;">
                                {{ item.ticker }}
                              </td>
                              <td align="right" class="nowrap" style="padding:10px 12px;font-size:13px;font-weight:700;color:#dc2626;">
                                {{ item.return_1m }}%
                              </td>
                              <td align="right" class="nowrap" style="padding:10px 12px;font-size:13px;font-weight:700;color:#dc2626;">
                                {{ item.return_1y }}%
                              </td>
                            </tr>
                            {% endfor %}
                          </tbody>
                        </table>
                      </div>
                    </div>
                  </td>
                  {% endif %}

                </tr>
              </table>
            </td>
          </tr>
          {% endif %}

          {# === TRADING ACTIVITY CARD === #}
          {% if (top_volume | default([]) | length > 0) or (top_value | default([]) | length > 0) %}
          <tr>
            <td class="content" style="padding:0 32px 24px 32px;">
              <h2 style="margin:0 0 12px 0;font-size:18px;line-height:26px;font-weight:700;color:#1f2937;">
                üíπ Trading Activity (90D)
              </h2>
              <div style="margin:0 0 12px 0;color:#6b7280;font-size:14px;line-height:20px;font-weight:500;">
                Top Volume &amp; Value Leaders
              </div>
              <table role="presentation" cellpadding="0" cellspacing="0" border="0" width="100%" style="border-collapse:collapse;">
                <tr class="two-col">

                  {% if top_volume | default([]) | length > 0 %}
                  <!-- Top Volume -->
                  <td class="col" style="width:48%;padding-right:16px;vertical-align:top;">
                    <div style="border:1px solid #e5e7eb;border-radius:8px;overflow:hidden;">
                      <div style="padding:16px;background:#f3f4f6;border-bottom:1px solid #e5e7eb;">
                        <div style="font-weight:700;font-size:14px;color:#1f2937;">üìä Top Volume</div>
                      </div>
                      <div class="table-wrap" style="overflow-x:auto;">
                        <table role="presentation" cellpadding="0" cellspacing="0" border="0" width="100%" style="border-collapse:collapse;">
                          <thead>
                            <tr style="background:#f9fafb;">
                              <th align="left" style="padding:10px 12px;font-size:11px;font-weight:600;color:#374151;text-transform:uppercase;">Ticker</th>
                              <th align="right" style="padding:10px 12px;font-size:11px;font-weight:600;color:#374151;text-transform:uppercase;">Volume</th>
                            </tr>
                          </thead>
                          <tbody>
                            {% for v in top_volume %}
                            <tr style="border-bottom:1px solid #f3f4f6;">
                              <td style="padding:10px 12px;font-size:13px;color:#1f2937;font-weight:600;">
                                {{ v.ticker }}
                              </td>
                              <td align="right" class="nowrap" style="padding:10px 12px;font-size:13px;font-weight:600;color:#2563eb;">
                                {{ v.volume | format_abbrev }}
                              </td>
                            </tr>
                            {% endfor %}
                          </tbody>
                        </table>
                      </div>
                    </div>
                  </td>
                  {% endif %}

                  {% if top_value | default([]) | length > 0 %}
                  <!-- Top Value -->
                  <td class="col" style="width:48%;padding-left:16px;vertical-align:top;">
                    <div style="border:1px solid #e5e7eb;border-radius:8px;overflow:hidden;">
                      <div style="padding:16px;background:#f3f4f6;border-bottom:1px solid #e5e7eb;">
                        <div style="font-weight:700;font-size:14px;color:#1f2937;">üí∞ Top Value</div>
                      </div>
                      <div class="table-wrap" style="overflow-x:auto;">
                        <table role="presentation" cellpadding="0" cellspacing="0" border="0" width="100%" style="border-collapse:collapse;">
                          <thead>
                            <tr style="background:#f9fafb;">
                              <th align="left" style="padding:10px 12px;font-size:11px;font-weight:600;color:#374151;text-transform:uppercase;">Ticker</th>
                              <th align="right" style="padding:10px 12px;font-size:11px;font-weight:600;color:#374151;text-transform:uppercase;">Value</th>
                            </tr>
                          </thead>
                          <tbody>
                            {% for v in top_value %}
                            <tr style="border-bottom:1px solid #f3f4f6;">
                              <td style="padding:10px 12px;font-size:13px;color:#1f2937;font-weight:600;">
                                {{ v.ticker }}
                              </td>
                              <td align="right" class="nowrap" style="padding:10px 12px;font-size:13px;font-weight:600;color:#2563eb;">
                                {{ v.value | format_idr_abbrev }}
                              </td>
                            </tr>
                            {% endfor %}
                          </tbody>
                        </table>
                      </div>
                    </div>
                  </td>
                  {% endif %}

                </tr>
              </table>
            </td>
          </tr>
          {% endif %}

          <!-- Footer -->
          <tr>
            <td class="content" style="padding:24px 32px 32px 32px;border-top:1px solid #f3f4f6;">
              <div style="text-align:center;font-size:12px;line-height:18px;color:#6b7280;">
                <p style="margin:0 0 8px 0;">
                  From <a href="https://sectors.app/" target="_blank" style="color:#9E0142;text-decoration:underline;font-weight:700;">Sectors.app</a>
                </p>
                <p style="margin:0;">¬© 2025 Sectors.app. All rights reserved.</p>
              </div>
            </td>
          </tr>

        </table>
      </td>
    </tr>
  </table>
</body>
</html>
